<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>Token Check</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      textarea {
        width: 100%;
        height: 120px;
      }
      #result {
        margin-top: 20px;
        font-size: 1.2em;
      }
    </style>
  </head>
  <body>
    <h2>ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼</h2>

    <label for="token">ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³:</label><br />
    <textarea
      id="token"
      placeholder="ã“ã“ã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„"
    ></textarea
    ><br /><br />

    <button onclick="checkToken()">æ¤œè¨¼ã™ã‚‹</button>

    <div id="result"></div>

    <script>
      async function checkToken() {
        const token = document.getElementById("token").value.trim();
        const resultDiv = document.getElementById("result");

        if (!token) {
          resultDiv.innerHTML =
            "<span style='color:red;'>ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</span>";
          return;
        }

        resultDiv.innerHTML = "æ¤œè¨¼ä¸­...";

        try {
          const res = await fetch(
            "http://localhost:8888/CharacomMauiHP/api/get_top_folders.php",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ token }),
            }
          );

          const data = await res.json();

          if (data.success) {
            let html = `
    âœ… æœ‰åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ã§ã™<br>
    <strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID:</strong> ${data.userId}
    <h3>ãƒ•ã‚©ãƒ«ãƒ€ä¸€è¦§</h3>
  `;

            if (
              Array.isArray(data.folderItems) &&
              data.folderItems.length > 0
            ) {
              data.folderItems.forEach((item) => {
                html += `
        ğŸ“ <strong>${item.name}</strong><br>
        ID: ${item.id}<br><br>
      `;
              });
            } else {
              html += "<p>ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>";
            }

            resultDiv.innerHTML = html;
          } else {
            resultDiv.innerHTML = `
              âŒ ç„¡åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³<br>
              <strong>ç†ç”±:</strong> ${data.error}
            `;
          }
        } catch (err) {
          resultDiv.innerHTML = `<span style='color:red;'>é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</span>`;
        }
      }
    </script>
  </body>
</html>
